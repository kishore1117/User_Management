<div class="card">
    <p-table #dt2 [value]="filteredUsers" dataKey="id" [rows]="10" [rowsPerPageOptions]="[10, 25, 50]"
        [loading]="loading" [globalFilterFields]="['name', 'hostname', 'department_name']" [paginator]="true"
        [tableStyle]="{ 'min-width': '10rem' }">

        <ng-template #header>


            <tr>
                <th>
                    <p-columnFilter type="text" field="name" placeholder="Type to search" ariaLabel="Filter Name"
                        filterOn="input"></p-columnFilter>
                </th>

                <th>
                    <p-columnFilter type="text" field="hostname" placeholder="Enter key to search"
                        ariaLabel="Filter hostname" filterOn="input"></p-columnFilter>
                </th>

                <th>
                    <p-columnFilter field="department_name" matchMode="in" [showMenu]="false">
                        <ng-template #filter let-value let-filter="filterCallback">

                            <!-- FIXED MULTISELECT -->
                            <p-multiselect [(ngModel)]="selectedDepartments" [options]="departments" optionLabel="label"
                                placeholder="Filter by department" [appendTo]="'body'" [showClear]="true"
                                (onChange)="filterByDepartment($event.value)" (onClear)="clearFilter()"
                                style="min-width: 14rem" [panelStyle]="{ minWidth: '16rem' }">
                            </p-multiselect>

                        </ng-template>
                    </p-columnFilter>
                </th>

                <th>
                    <p-columnFilter field="status" matchMode="equals" [showMenu]="false">
                        <ng-template #filter let-value let-filter="filterCallback">
                            <p-select [(ngModel)]="selectedStatus" [options]="ipStatuses"
                                (onChange)="filterByStatus($event.value)" (onClear)="clearFilter()"
                                placeholder="Filter by IP Status" [showClear]="true" style="min-width: 14rem">
                                <ng-template let-option #item>
                                    <p-tag [value]="option.value" [severity]="getSeverity(option.value)"></p-tag>
                                </ng-template>
                            </p-select>
                        </ng-template>
                    </p-columnFilter>
                </th>
                <th>

                </th>
                <th>

                </th>
                <th>

                </th>
                <th>

                </th>
                <th>
                </th>
            </tr>
            <tr>
                <th style="width:22%">Name</th>
                <th style="width:22%">Hostname</th>
                <th style="width:22%">Department</th>
                <th style="width:22%">Status</th>
                <th style="width: 22%">Location</th>
                <th style="width: 22%">Category</th>
                <th style="width: 22%">IP_address1</th>
                <th style="width: 22%">IP_address2</th>
                <th style="width:12%"></th>
            </tr>

        </ng-template>

        <ng-template #body let-row>
            <tr>
                <td>{{ row.name }}</td>
                <td>{{ row.hostname }}</td>
                <td>{{ row.department_name }}</td>

                <td>
                    <p-tag [value]="getStatus(row)" [severity]="getSeverity(getStatus(row))">
                    </p-tag>
                </td>
                <td>
                    {{ row.location_name }}
                </td>
                <td>
                    {{ row.category_name}}
                </td>
                <td>
                    {{ row.ip_address1}}
                </td>
                <td>
                    {{ row.ip_address2}}
                </td>

                <td (click)="viewUser(row.id)" style="cursor:pointer;">
                    <i class="pi pi-arrow-right" style="font-size: 1.4rem;" [ngClass]="{
            'text-green-500 pi-check-circle': row.verified,
            'text-red-500 pi-times-circle': !row.verified
       }">
                    </i>
                </td>
            </tr>
        </ng-template>

        <ng-template #emptymessage>
            <tr>
                <td colspan="5">No users available.</td>
            </tr>
        </ng-template>
    </p-table>
</div>